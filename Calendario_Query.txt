let
    lista_fechas=Table.Column(Ventas_Impulso,"FECHA"),
    fecha_minima=#date(Date.Year(List.Min(lista_fechas)),1,1),
    fecha_maxima=#date(Date.Year(List.Max(lista_fechas)),12,31),
    dias=Number.From(fecha_maxima - fecha_minima)+1,
    fechas=List.Dates(fecha_minima,dias,#duration(1,0,0,0)),
    #"Conviertida en tabla"=Table.FromList(fechas,Splitter.SplitByNothing(),null,null,ExtraValues.Error),
    #"Tipo cambiado" = Table.TransformColumnTypes(#"Conviertida en tabla",{{"Column1", type date}}),
    #"Columnas con nombre cambiado" = Table.RenameColumns(#"Tipo cambiado",{{"Column1", "Fecha"}}),
    #"Año insertado" = Table.AddColumn(#"Columnas con nombre cambiado", "Año", each Date.Year([Fecha]), Int64.Type),
    #"Nombre del mes insertado" = Table.AddColumn(#"Año insertado", "Nombre del mes", each Date.MonthName([Fecha]), type text),
    #"Mes insertado" = Table.AddColumn(#"Nombre del mes insertado", "Mes", each Date.Month([Fecha]), Int64.Type),
    #"Trimestre insertado" = Table.AddColumn(#"Mes insertado", "Trimestre", each Date.QuarterOfYear([Fecha]), Int64.Type),
    #"Semana del año insertada" = Table.AddColumn(#"Trimestre insertado", "Semana del año", each Date.WeekOfYear([Fecha],1), Int64.Type),
    #"Semana del mes insertada" = Table.AddColumn(#"Semana del año insertada", "Semana del mes", each Date.WeekOfMonth([Fecha],1), Int64.Type),
    #"Día insertado" = Table.AddColumn(#"Semana del mes insertada", "Dia", each Date.Day([Fecha]), Int64.Type),
    #"Nombre del día insertado" = Table.AddColumn(#"Día insertado", "Nombre del dia", each Date.DayOfWeekName([Fecha]), type text),
    #"Tipo cambiado1" = Table.TransformColumnTypes(#"Nombre del día insertado",{{"Semana del mes", type text}}),
    #"Personalizada agregada" = Table.AddColumn(#"Tipo cambiado1", "Personalizado", each "Semana"&" "&[Semana del mes]),
    #"Columnas con nombre cambiado1" = Table.RenameColumns(#"Personalizada agregada",{{"Personalizado", "Semana_mes"}}),
    #"Tipo cambiado2" = Table.TransformColumnTypes(#"Columnas con nombre cambiado1",{{"Semana del mes", Int64.Type}})
in
    #"Tipo cambiado2"